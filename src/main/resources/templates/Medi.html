<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Medicals and Medicines</title>
    <style>
        body {
          font-family: 'Inter', sans-serif;
          background-color: #f9fafb;
          color: #111827;
          padding: 32px;
          margin: 0;
        }
        h1 {
          margin-bottom: 24px;
          font-weight: 800;
          font-size: 2rem;
          text-align: center;
        }
        .container {
          max-width: 800px;
          margin: 0 auto;
          display: flex;
          flex-direction: column;
    align-items: center;
    gap: 48px;
  }
  .pie-chart-container {
    position: relative;
    width: 320px;
    height: 320px;
  }
  svg {
    display: block;
    margin: 0 auto;
    width: 320px;
    height: 320px;
  }
  .slice {
    cursor: pointer;
    transition: filter 0.3s ease;
    outline: none;
  }
  .slice:hover,
  .slice:focus {
    filter: brightness(0.85);
  }
  .pending { fill: #fbbf24; }   /* amber-400 */
  .accepted { fill: #22c55e; }  /* green-500 */
  .rejected { fill: #ef4444; }  /* red-500 */
  .legend {
    display: flex;
    justify-content: center;
    gap: 32px;
    margin-top: 16px;
    flex-wrap: wrap;
  }
  .legend-item {
    display: flex;
    align-items: center;
    gap: 8px;
    font-weight: 600;
    font-size: 1rem;
    user-select: none;
  }
  .legend-color {
    width: 20px;
    height: 20px;
    border-radius: 50%;
    flex-shrink: 0;
  }
   .pending-color { background-color: #fbbf24; }
  .accepted-color { background-color: #22c55e; }
  .rejected-color { background-color: #ef4444; }
  table {
    border-collapse: collapse;
    width: 100%;
    max-width: 800px;
    background: white;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgb(0 0 0 / 0.1);
    overflow: hidden;
    margin-top: 16px;
  }
   th, td {
    padding: 14px 20px;
    text-align: left;
    border-bottom: 1px solid #e5e7eb;
  }
  th {
    background-color: #f3f4f6;
    font-weight: 700;
    color: #374151;
  }
  tbody tr:hover {
    background-color: #f9fafb;
  }
  .items-table {
    display: none;
  }
   .items-table.active {
    display: table;
  }
  @media (max-width: 640px) {
    .container {
      padding: 0 16px;
    }
    .pie-chart-container, svg {
      width: 100%;
      height: auto;
    }
  }
   .slice:focus {
    outline: 3px solid #2563eb;
    outline-offset: 3px;
  }
    </style>

      </head>
      <body>
      <!-- this is a right nav bar -->
      <div>
          <ul>
              <li>
                  <a th:href="@{/admin/medi">Medicines and Medicals</a>
              </li>
              <li>
                  <a th:href="@{/admin/volunteer}">Volunteers Requested</a>
              </li>
          </ul>
      </div>

      <!-- In the middle -->
      <div class="container">
          <!-- this is the medical pie chart -->
          <div>
          <div class="pie-chart-container" role="img" aria-label="pie chart of medicals" tabindex="0">
              <svg viewBox="0 0 200 200" aria-hidden="true" focusable="false" role="presentation">
                  <th:block th:with="total=${pendingMedicalsCount} + ${acceptingMedicalsCount} + ${rejectingMedicalsCount}">
                      <th:block th:if="${total} == 0">
                          <circle cx="100" cy="100" r="90" fill="#e5e7eb" />
                          <text x="100" y="105" text-anchor="middle" fill="#6b7280" font-size="14">No data</text>
                      </th:block>
                      <th:block th:unless="${total} == 0"
                                th:with="
                      pPending = ${pendingMedicalsCount} / total,
                      pAccepted = ${acceptingMedicalsCount} / total,
                      pRejected = ${rejectingMedicalsCount} / total,
                      aPending = pPending * 2 * 3.14159265359,
                      aAccepted = pAccepted * 2 * 3.14159265359,
                      aRejected = pRejected * 2 * 3.14159265359,
                      cx = 100,
                      cy = 100,
                      r = 90,
                      sx = cx + r * T(java.lang.Math).cos(- 3.14159265359/2),
                      sy = cy + r * T(java.lang.Math).sin(- 3.14159265359/2),
                      p1x = cx + r * T(java.lang.Math).cos(- 3.14159265359/2 + aPending),
                      p1y = cy + r * T(java.lang.Math).sin(- 3.14159265359/2 + aPending),
                      p2x = cx + r * T(java.lang.Math).cos(- 3.14159265359/2 + aPending + aAccepted),
                      p2y = cy + r * T(java.lang.Math).sin(- 3.14159265359/2 + aPending + aAccepted)
                    ">
                          <!-- Pending slice -->
                          <path tabindex="0" role="button" aria-label="Pending: [[${pendingMedicalsCount}]] items"
                                data-status="pending" class="slice pending"
                                th:attr="d=${T(java.lang.String).format('M %f %f L %f %f A %f %f 0 %d 1 %f %f Z',
                  cx, cy, sx, sy, r, r, (aPending > 3.14159265359) ? 1 : 0, p1x, p1y)}"
                          ></path>

                          <!-- Accepted slice -->
                          <path tabindex="0" role="button" aria-label="Accepted: [[${acceptingMedicalsCount}]] items"
                                data-status="accepted" class="slice accepted"
                                th:attr="d=${T(java.lang.String).format('M %f %f L %f %f A %f %f 0 %d 1 %f %f Z',
                  cx, cy, p1x, p1y, r, r, (aAccepted > 3.14159265359) ? 1 : 0, p2x, p2y)}"
                          ></path>

                          <!-- Rejected slice -->
                          <path tabindex="0" role="button" aria-label="Rejected: [[${rejectingMedicalsCount}]] items"
                                data-status="rejected" class="slice rejected"
                                th:attr="d=${T(java.lang.String).format('M %f %f L %f %f A %f %f 0 %d 1 %f %f Z',
                  cx, cy, p2x, p2y, r, r, (aRejected > 3.14159265359) ? 1 : 0,
                  sx, sy)}"
                          ></path>
                      </th:block>
                  </th:block>
              </svg>
          </div>

          <div class="legend" role="list" aria-label="Status legend">
              <div class="legend-item" role="listitem">
                  <span class="legend-color pending-color"></span>Pending (<span th:text="${pendingMedicalsCount}">0</span>)
              </div>
              <div class="legend-item" role="listitem">
                  <span class="legend-color accepted-color"></span>Accepted (<span th:text="${acceptingMedicalsCount}">0</span>)
              </div>
              <div class="legend-item" role="listitem">
                  <span class="legend-color rejected-color"></span>Rejected (<span th:text="${rejectingMedicalsCount}">0</span>)
              </div>
          </div>
          </div>
        <div>
            <!-- this is for medicines -->
            <div class="pie-chart-container" role="img" aria-label="pie chart of medicines" tabindex="0">
                <svg viewBox="0 0 200 200" aria-hidden="true" focusable="false" role="presentation">
                    <th:block th:with="total=${pendingMedicinesCount} + ${acceptingMedicinesCount} + ${rejectingMedicinesCount}">
                        <th:block th:if="${total} == 0">
                            <circle cx="100" cy="100" r="90" fill="#e5e7eb" />
                            <text x="100" y="105" text-anchor="middle" fill="#6b7280" font-size="14">No data</text>
                        </th:block>
                        <th:block th:unless="${total} == 0"
                                  th:with="
                      pPending = ${pendingMedicinesCount} / total,
                      pAccepted = ${acceptingMedicinesCount} / total,
                      pRejected = ${rejectingMedicinesCount} / total,
                      aPending = pPending * 2 * 3.14159265359,
                      aAccepted = pAccepted * 2 * 3.14159265359,
                      aRejected = pRejected * 2 * 3.14159265359,
                      cx = 100,
                      cy = 100,
                      r = 90,
                      sx = cx + r * T(java.lang.Math).cos(- 3.14159265359/2),
                      sy = cy + r * T(java.lang.Math).sin(- 3.14159265359/2),
                      p1x = cx + r * T(java.lang.Math).cos(- 3.14159265359/2 + aPending),
                      p1y = cy + r * T(java.lang.Math).sin(- 3.14159265359/2 + aPending),
                      p2x = cx + r * T(java.lang.Math).cos(- 3.14159265359/2 + aPending + aAccepted),
                      p2y = cy + r * T(java.lang.Math).sin(- 3.14159265359/2 + aPending + aAccepted)
                    ">
                            <!-- Pending slice -->
                            <path tabindex="0" role="button" aria-label="Pending: [[${pendingMedicinesCount}]] items"
                                  data-status="pending" class="slice pending"
                                  th:attr="d=${T(java.lang.String).format('M %f %f L %f %f A %f %f 0 %d 1 %f %f Z',
                  cx, cy, sx, sy, r, r, (aPending > 3.14159265359) ? 1 : 0, p1x, p1y)}"
                            ></path>

                            <!-- Accepted slice -->
                            <path tabindex="0" role="button" aria-label="Accepted: [[${acceptingMedicinesCount}]] items"
                                  data-status="accepted" class="slice accepted"
                                  th:attr="d=${T(java.lang.String).format('M %f %f L %f %f A %f %f 0 %d 1 %f %f Z',
                  cx, cy, p1x, p1y, r, r, (aAccepted > 3.14159265359) ? 1 : 0, p2x, p2y)}"
                            ></path>

                            <!-- Rejected slice -->
                            <path tabindex="0" role="button" aria-label="Rejected: [[${rejectingMedicinesCount}]] items"
                                  data-status="rejected" class="slice rejected"
                                  th:attr="d=${T(java.lang.String).format('M %f %f L %f %f A %f %f 0 %d 1 %f %f Z',
                  cx, cy, p2x, p2y, r, r, (aRejected > 3.14159265359) ? 1 : 0,
                  sx, sy)}"
                            ></path>
                        </th:block>
                    </th:block>
                </svg>
            </div>

            <div class="legend" role="list" aria-label="Status legend">
                <div class="legend-item" role="listitem">
                    <span class="legend-color pending-color"></span>Pending (<span th:text="${pendingMedicinesCount}">0</span>)
                </div>
                <div class="legend-item" role="listitem">
                    <span class="legend-color accepted-color"></span>Accepted (<span th:text="${acceptingMedicinesCount}">0</span>)
                </div>
                <div class="legend-item" role="listitem">
                    <span class="legend-color rejected-color"></span>Rejected (<span th:text="${rejectingMedicinesCount}">0</span>)
                </div>
            </div>
        </div>

          <!-- Tables should be under the the both diagrams -->
          <div>
              <!--for medicals -->
              <div>
                  <!-- Pending -->
                  <table id="pending-medical-table" class="items-table">
                      <thead>
                      <tr>
                          <th>Name</th>
                          <th>Description</th>
                          <th>Donor</th>
                      </tr>
                      </thead>
                      <tbody>
                      <tr th:each="medical : ${pendingMedicals}">
                          <td th:text="${medical.name}">Item Name</td>
                          <td th:text="${medical.description}">Description</td>
                          <td th:text="${medical.member.username}">Donor</td>
                      </tr>
                      <tr th:if="${#lists.isEmpty(pendingMedicals)}">
                          <td colspan="2" style="text-align:center; color:#6b7280;">No pending items</td>
                      </tr>
                      </tbody>
                  </table>

                  <!-- Accepted table -->
                  <table id="accepted-medical-table" class="items-table">
                      <thead>
                      <tr>
                          <th>Name</th>
                          <th>Description</th>
                          <th>Donor</th>
                          <th>Requested To get</th>
                          <th>Member To get</th>
                      </tr>
                      </thead>
                      <tbody>
                      <tr th:each="medical : ${acceptingMedicals}">
                          <td th:text="${medical.name}">Item Name</td>
                          <td th:text="${medical.description}">Description</td>
                          <td th:text="${medical.member.username}">Donor</td>
                          <td th:text="${medical.requested}">Requested To get</td>
                          <td th:text="${medical.memberToGet}">Member to get</td>
                      </tr>
                      <tr th:if="${#lists.isEmpty(acceptingMedicals)}">
                          <td colspan="2" style="text-align:center; color:#6b7280;">No accepted items</td>
                      </tr>
                      </tbody>
                  </table>

                  <!-- Rejected table -->
                  <table id="rejected-medical-table" class="items-table">
                      <thead>
                      <tr>
                          <th>Name</th>
                          <th>Description</th>
                          <th>Donor</th>
                      </tr>
                      </thead>
                      <tbody>
                      <tr th:each="medical : ${rejectingMedicals}">
                          <td th:text="${medical.name}">Item Name</td>
                          <td th:text="${medical.description}">Description</td>
                          <td th:text="${medical.member.username}">Donor</td>
                      </tr>
                      <tr th:if="${#lists.isEmpty(rejectingMedicals)}">
                          <td colspan="2" style="text-align:center; color:#6b7280;">No rejected items</td>
                      </tr>
                      </tbody>
                  </table>
              </div>

              <!--for medicines -->
              <div>
                  <!-- Pending -->
                  <table id="pending-table" class="items-table">
                      <thead>
                      <tr>
                          <th>Name</th>
                          <th>Description</th>
                          <th>Donor</th>
                      </tr>
                      </thead>
                      <tbody>
                      <tr th:each="medicine : ${pendingMedicines}">
                          <td th:text="${medicine.name}">Item Name</td>
                          <td th:text="${medicine.description}">Description</td>
                          <td th:text="${medicine.member.username}">Donor</td>
                      </tr>
                      <tr th:if="${#lists.isEmpty(pendingMedicines)}">
                          <td colspan="2" style="text-align:center; color:#6b7280;">No pending items</td>
                      </tr>
                      </tbody>
                  </table>

                  <!-- Accepted table -->
                  <table id="accepted-table" class="items-table">
                      <thead>
                      <tr>
                          <th>Name</th>
                          <th>Description</th>
                          <th>Donor</th>
                          <th>Requested To get</th>
                          <th>Member To get</th>
                      </tr>
                      </thead>
                      <tbody>
                      <tr th:each="medicine : ${acceptingMedicines}">
                          <td th:text="${medicine.name}">Item Name</td>
                          <td th:text="${medicine.description}">Description</td>
                          <td th:text="${medicine.member.username}">Donor</td>
                          <td th:text="${medicine.requested}">Requested To get</td>
                          <td th:text="${medicine.memberToGet}">Member to get</td>
                      </tr>
                      <tr th:if="${#lists.isEmpty(acceptingMedicines)}">
                          <td colspan="2" style="text-align:center; color:#6b7280;">No accepted items</td>
                      </tr>
                      </tbody>
                  </table>

                  <!-- Rejected table -->
                  <table id="rejected-table" class="items-table">
                      <thead>
                      <tr>
                          <th>Name</th>
                          <th>Description</th>
                          <th>Donor</th>
                      </tr>
                      </thead>
                      <tbody>
                      <tr th:each="medicine : ${rejectingMedicines}">
                          <td th:text="${medicine.name}">Item Name</td>
                          <td th:text="${medicine.description}">Description</td>
                          <td th:text="${medicine.member.username}">Donor</td>
                      </tr>
                      <tr th:if="${#lists.isEmpty(rejectingMedicines)}">
                          <td colspan="2" style="text-align:center; color:#6b7280;">No rejected items</td>
                      </tr>
                      </tbody>
                  </table>
              </div>

          </div>

      </div>

      </body>
      </html>